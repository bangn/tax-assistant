- receipt ||= Receipt.new
= form_for(receipt, html: { multipart: true }) do |form|
  .space-y-4
    = form.text_field :seller, placeholder: "Seller", class: "block w-full rounded-lg border p-2"
    = form.text_field :description, placeholder: "Description", class: "block w-full rounded-lg border p-2"
    = form.number_field :total_amount, step: 0.01, placeholder: "Total Amount", class: "block w-full rounded-lg border p-2"
    = form.date_field :date, placeholder: "Date", class: "block w-full rounded-lg border p-2"
    = form.text_area :note, placeholder: "Note", class: "block w-full rounded-lg border p-2"
    - if receipt.image.representable?
      %div.container.border.mt-5.border-gray-300.rounded-lg.p-2
        = link_to rails_blob_path(receipt.image, disposition: "attachment") do
          = image_tag receipt.image, title: "Download receipt"

    .relative.items-center
      = form.file_field :image,
          type: "file",
          class: "absolute inset-0 w-full h-full opacity-0 cursor-pointer",
          id: "file_input",
          onchange: 'previewReceipt(event)',
          direct_upload: true
      .flex.items-center.justify-center.px-4.py-2.bg-white.border.border-gray-300.rounded-md.shadow-sm.hover:bg-gray-50
        = heroicon "arrow-up-tray"
        - if receipt.image.representable?
          %span.ml-2.text-sm.text-gray-600 Upload new receipt
        - else
          %span.ml-2.text-sm.text-gray-600 Upload receipt

    #receipt-preview-container.container.border.border-gray-300.mt-5{ style: 'display: none;' }
      = image_tag '#',
          id: 'receipt-preview',
          alt: 'Receipt Preview'

    .flex.justify-between.items-center
      %div.flex-grow
        = form.submit "Save",
            class: "bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg cursor-pointer",
            method: :post
      - if receipt.persisted?
        %label.bg-rose-400.hover:bg-rose-500.text-white.font-bold.py-2.px-4.rounded-lg.cursor-pointer{for: "delete"}
          = heroicon "trash"
%div
  - if receipt.persisted?
    = button_to "",
        receipt_path(receipt),
        id: "delete",
        hidden: true,
        method: :delete,
        data: { confirm: "Are you sure you want to delete this receipt?" }

:javascript
  function previewReceipt(event) {
    const input = event.target;
    const previewContainer = document.getElementById('receipt-preview-container');
    const previewImage = document.getElementById('receipt-preview');

    if (input.files && input.files[0]) {
      const reader = new FileReader();

      reader.onload = function(e) {
        previewImage.src = e.target.result;
        previewContainer.style.display = 'block';
      }

      reader.readAsDataURL(input.files[0]);
    } else {
      previewContainer.style.display = 'none';
    }
  }
