- receipt ||= Receipt.new
= form_for(receipt, html: { multipart: true }) do |form|
  .space-y-4
    = form.text_field :seller, placeholder: "Seller", class: "block w-full rounded-lg border p-2"
    = form.text_field :description, placeholder: "Description", class: "block w-full rounded-lg border p-2"
    = form.number_field :total_amount, step: 0.01, placeholder: "Total Amount", class: "block w-full rounded-lg border p-2"
    = form.date_field :date, placeholder: "Date", class: "block w-full rounded-lg border p-2"
    = form.text_area :note, placeholder: "Note", class: "block w-full rounded-lg border p-2"
    - if receipt.image.representable?
      .flex.items-center.space-x-4
        %span.text-medium
          = "Your Receipt"
        %span.text-sm.text-gray-600
          = link_to rails_blob_path(receipt.image, disposition: "attachment") do
            = image_tag "receipt.png", alt: "Download"
      .container.rounded-lg.border
        = image_tag receipt.image
      %label.block.mb-2.text-medium{for: "file_input"} Upload New Receipt
    - else
      %label.block.mb-2.text-medium{for: "file_input"} Upload Receipt
    = form.file_field :image,
        type: "file",
        class: "block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer focus:outline-none dark:border-gray-600",
        id: "file_input",
        onchange: 'previewAvatar(event)',
        class: 'form-control-file'
    #avatar-preview-container{ style: 'display: none;' }
      = image_tag '#',
          id: 'avatar-preview',
          alt: 'Avatar Preview',
          style: 'max-width: 200px; max-height: 200px;'

    .flex.justify-between.items-center
      %div.flex-grow
        = form.submit "Save",
            class: "bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg cursor-pointer",
            method: :post
      - if receipt.persisted?
        %label.bg-rose-400.hover:bg-rose-500.text-white.font-bold.py-2.px-4.rounded-lg.cursor-pointer{for: "delete"} Delete
%div
  - if receipt.persisted?
    = button_to "",
        receipt_path(receipt),
        id: "delete",
        hidden: true,
        method: :delete,
        data: { confirm: "Are you sure you want to delete this receipt?" }

:javascript
  function previewAvatar(event) {
    const input = event.target;
    const previewContainer = document.getElementById('avatar-preview-container');
    const previewImage = document.getElementById('avatar-preview');

    if (input.files && input.files[0]) {
      const reader = new FileReader();

      reader.onload = function(e) {
        previewImage.src = e.target.result;
        previewContainer.style.display = 'block';
      }

      reader.readAsDataURL(input.files[0]);
    } else {
      previewContainer.style.display = 'none';
    }
  }
